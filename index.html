<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Selfie AR - Vivari Beach Club</title>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
  body { margin:0; background:#000; overflow:hidden; font-family:Arial,sans-serif; }
  #cameraVideo {
    position:fixed; top:0; left:0; width:100vw; height:100vh;
    object-fit:cover; z-index:0;
  }
  #modelContainer {
    position:fixed; top:0; left:0; width:100vw; height:100vh;
    z-index:1;
    pointer-events:none; /* deixa o clique passar pro model-viewer */
  }
  model-viewer {
    width:80%;
    height:80%;
    position:absolute;
    top:10%;
    left:10%;
    opacity:0.9;
    pointer-events:auto;
  }
  #captureBtn {
    position:absolute; bottom:30px; left:50%; transform:translateX(-50%);
    z-index:10;
    padding:28px 36px; border:none; border-radius:20px;
    background:#0b84ff; color:#fff; font-weight:bold; font-size:26px;
    cursor:pointer; box-shadow:0 6px 12px rgba(0,0,0,0.4);
  }
</style>
</head>
<body>

<video id="cameraVideo" autoplay playsinline muted></video>

<div id="modelContainer">
  <model-viewer id="model" src="vivi.glb"
                alt="Vivi 3D"
                camera-controls
                auto-rotate
                environment-image="neutral"
                shadow-intensity="1">
  </model-viewer>
</div>

<button id="captureBtn">ðŸ“¸ Tirar Selfie</button>

<script>
  // Acessa cÃ¢mera
  const video = document.getElementById('cameraVideo');
  navigator.mediaDevices.getUserMedia({ video:{ facingMode:"user" } })
    .then(stream => video.srcObject = stream)
    .catch(err => console.error('Erro ao acessar cÃ¢mera:', err));

  // Captura a tela inteira (vÃ­deo + modelo)
  const captureBtn = document.getElementById('captureBtn');
  captureBtn.addEventListener('click', () => {
    html2canvas(document.body).then(canvas => {
      const ctx = canvas.getContext("2d");

      // Marca dâ€™Ã¡gua
      ctx.font = `${Math.floor(canvas.height/20)}px Arial`;
      ctx.fillStyle = "rgba(255,255,255,0.6)";
      ctx.textAlign = "right";
      ctx.fillText("Vivari Beach Club", canvas.width-20, canvas.height-20);

      // Salvar
      const link = document.createElement('a');
      link.download = 'selfie_vivi.png';
      link.href = canvas.toDataURL("image/png");
      link.click();
    });
  });
</script>

</body>
</html>
