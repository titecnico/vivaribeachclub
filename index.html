<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Vivi 3D</title>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<style>
  body { margin: 0; background-color: #000; overflow: hidden; }
  model-viewer { width: 100vw; height: 100vh; }
  #captureBtn {
    position: absolute; top: 12px; right: 12px; z-index: 10;
    padding: 10px 16px; border: none; border-radius: 8px;
    background: #0b84ff; color: #fff; font-weight: bold; cursor: pointer;
  }
</style>
</head>
<body>

<model-viewer id="model" src="vivi.glb" 
              alt="Vivi 3D" 
              auto-rotate 
              camera-controls 
              environment-image="neutral"
              shadow-intensity="1"
              style="background-color: #000;">
</model-viewer>

<button id="captureBtn">ðŸ“¸ Tirar selfie</button>

<script>
  // Webcam selfie
  const video = document.createElement('video');
  video.autoplay = true;
  video.muted = true;
  video.playsInline = true;
  video.style.display = 'none';
  document.body.appendChild(video);

  navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } })
    .then(stream => video.srcObject = stream)
    .catch(err => console.error('Erro cÃ¢mera:', err));

  document.getElementById('captureBtn').addEventListener('click', () => {
    const w = window.innerWidth, h = window.innerHeight;
    const canvas = document.createElement('canvas');
    canvas.width = w;
    canvas.height = h;
    const ctx = canvas.getContext('2d');

    // VÃ­deo espelhado
    ctx.save();
    ctx.translate(w, 0);
    ctx.scale(-1, 1);
    ctx.drawImage(video, 0, 0, w, h);
    ctx.restore();

    // Render do model-viewer
    const modelViewer = document.getElementById('model');
    ctx.drawImage(modelViewer, 0, 0, w, h);

    // Salvar imagem
    const link = document.createElement('a');
    link.download = 'selfie_vivi.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  });
</script>

</body>
</html>
