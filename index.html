<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Selfie com Vivi 3D</title>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
  body { margin:0; background-color:#000; overflow:hidden; }
  model-viewer { width:100vw; height:100vh; display:block; }
  #videoCam { position:absolute; top:0; left:0; width:100vw; height:100vh; object-fit:cover; z-index:1; opacity:0.5; }
  #captureBtn {
    position:absolute; top:12px; right:12px; z-index:10;
    padding:10px 16px; border:none; border-radius:8px;
    background:#0b84ff; color:#fff; font-weight:bold; cursor:pointer;
  }
</style>
</head>
<body>

<model-viewer id="model" src="vivi.glb" 
              alt="Vivi 3D" 
              auto-rotate 
              camera-controls 
              environment-image="neutral"
              shadow-intensity="1">
</model-viewer>

<video id="videoCam" autoplay muted playsinline></video>

<button id="captureBtn">ðŸ“¸ Tirar selfie</button>

<script>
  const video = document.getElementById('videoCam');

  navigator.mediaDevices.getUserMedia({ video: { facingMode:"user" } })
    .then(stream => video.srcObject = stream)
    .catch(err => console.error('Erro cÃ¢mera:', err));

  document.getElementById('captureBtn').addEventListener('click', async () => {
    // Captura a tela incluindo vÃ­deo + modelo
    const container = document.body;
    const canvas = await html2canvas(container, {useCORS:true, allowTaint:true});

    const ctx = canvas.getContext('2d');

    // Adiciona marca d'Ã¡gua
    ctx.font = "48px Arial";
    ctx.fillStyle = "rgba(255,255,255,0.6)";
    ctx.textAlign = "right";
    ctx.fillText("Vivari Beach Club", canvas.width - 20, canvas.height - 20);

    // Salvar imagem
    const link = document.createElement('a');
    link.download = 'selfie_vivi.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  });
</script>

</body>
</html>
